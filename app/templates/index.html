{% extends "layout.html" %}
{% block title %}CVE-Search{% endblock %}
{% block content %}

{% if new_cve %}
<div class="alert alert-dismissible alert-success">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  <strong>Well done!</strong> You successfully add {{ new_cve }}</a>.
</div>
{% endif %}

<nav class="navbar">
    <h1>CVE-S3arch</h1>
    <p class="nav navbar-nav navbar-right"><a href="https://twitter.com/alexfrancow" style="font-size:20px;"><img src="https://pbs.twimg.com/profile_images/1135232338508623873/KDGVryRs_400x400.png" height="50px" width="50px" style="border-radius: 50%;"/> @alexfrancow</a></p>
</nav>
<main id="cve-main">
  <nav id="cve-nav" class="rounded border-tw">
    <ul class="list-group">
    {% for row in rows %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="?cve={{ row[0]}}">{{ row[0]}}</a>
        <a href="/run?cve={{ row[0]}}" class="ml-auto pr-3"><i class="fas fa-play" aria-hidden="true"></i></a>
        <a href="/delete?cve={{ row[0]}}"><i id="delete-icon" class="fas fa-trash-alt" aria-hidden="true" style="display: none;"></i></a>
      </li>
    {% endfor %}
      <form id="CVEForm" style="margin-top: 20px;display:none;" action="/createCVE" method="post">
        <div class="input-group mb-3">
          <input type="text" class="form-control" name="cve" placeholder="CVE-XXXX-XXXX" aria-label="CVE-XXXX-XXXX" aria-describedby="basic-addon2" pattern="CVE-\d{4}-\d{4,7}">
          <div class="input-group-append">
            <input type="submit" value="Save CVE" class="input-group-text btn-primary" id="basic-addon2"></input>
          </div>
        </div>
      </form>

      <button onclick="openCVEForm()" id="add-cve" class="btn btn-default" style="vertical-align: middle;background-color: #77b300;color: white;">
        <i class="fas fa-plus"></i>
      </button>
      <button onclick="deleteMode()" id="delete-mode" class="btn btn-default" style="vertical-align: middle;background-color: #e02342;color: white;">
        <i class="fas fa-trash-alt"></i>
      </button>
    </ul>

 
  </nav>
  <header id="cve-info" class="rounded border-tw"> 
    <h2>{{ cve }}</h2>
    <p>{{ description }}</p>

    <h5>Timeseries plot for this vulnerability</h5>

    <div class="container" id="CVETimeseriesDiv">
    <canvas id="line-chart" width="500" height="150"></canvas>
    </div>


    
    <p>Google Links:</p>
    <table class="table table-hover">
	{% for gL in googleLinks %}
        <tr class="table-info">   
          <td><a href="{{ gL }}">{{ gL }}</a></td>
	  <td>INFO/Posible Exploit</td>
	</tr>
        {% endfor %}
    </table>

    <div id="cve-table"> </div>
    <small>*Description ref: <a href="https://nvd.nist.gov/vuln/detail/{{ cve }}">https://nvd.nist.gov/vuln/detail/{{ cve }}</a></small>
  </header> 
  <section id="cve-renderLink" class="rounded border-tw">
    <h2>Streaming Data</h2>
  </section>
</main>

<script type="text/javascript">
    window.onload = function() {
      $('.dropdown-toggle').dropdown();
      $.getJSON("json/data.json", function(json) {
          loadData(json);
      });
    };
</script>  

<script>
function deleteMode() {
  var x = document.getElementById("delete-icon");
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
</script>

<script type="text/javascript">
var ctx = document.getElementById("line-chart"); ctx.style.backgroundColor = 'rgba(255,255,255,255)';

new Chart(document.getElementById("line-chart"), {
  type: 'line',
  data: {
    labels: [1500,1600,1700,1750,1800,1850,1900,1950,1999,2050],
    datasets: [{ 
        data: [86,114,106,106,107,111,133,221,783,2478],
        label: "Africa",
        borderColor: "#3e95cd",
        fill: false
      }, { 
        data: [282,350,411,502,635,809,947,1402,3700,5267],
        label: "Asia",
        borderColor: "#8e5ea2",
        fill: false
      }, { 
        data: [168,170,178,190,203,276,408,547,675,734],
        label: "Europe",
        borderColor: "#3cba9f",
        fill: false
      }, { 
        data: [40,20,10,16,24,38,74,167,508,784],
        label: "Latin America",
        borderColor: "#e8c3b9",
        fill: false
      }, { 
        data: [6,3,2,2,7,26,82,172,312,433],
        label: "North America",
        borderColor: "#c45850",
        fill: false
      }
    ]
  },
  options: {
    title: {
      display: true,
      text: 'World population per region (in millions)'
    }
  }
});

</script>

{% endblock %} {% block footer %} {% endblock %}
