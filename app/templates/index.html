{% extends "layout.html" %}
{% block title %}CVE-Search{% endblock %}
{% block content %}

{% if new_cve %}
<div class="alert alert-dismissible alert-success">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  <strong>Well done!</strong> You successfully add {{ new_cve }}</a>.
</div>
{% endif %}

<nav class="navbar">
    <h1>CVE-S3arch</h1>
    <p class="nav navbar-nav navbar-right"><a href="https://twitter.com/alexfrancow" style="font-size:20px;"><img src="https://pbs.twimg.com/profile_images/1135232338508623873/KDGVryRs_400x400.png" height="50px" width="50px" style="border-radius: 50%;"/> @alexfrancow</a></p>
</nav>
<main id="cve-main">
  <nav id="cve-nav" class="rounded border-tw">
    <ul class="list-group">
    {% for row in rows %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="?cve={{ row[0]}}">{{ row[0]}}</a>
        <a href="/run?cve={{ row[0]}}" class="ml-auto pr-3"><i class="fas fa-play" aria-hidden="true"></i></a>
        <a href="/delete?cve={{ row[0]}}"><i id="delete-icon" class="delete-icon fas fa-trash-alt" aria-hidden="true" style="display: none;"></i></a>
      </li>
    {% endfor %}
      <form id="CVEForm" style="margin-top: 20px;display:none;" action="/createCVE" method="post">
        <div class="input-group mb-3">
          <input type="text" class="form-control" name="cve" placeholder="CVE-XXXX-XXXX" aria-label="CVE-XXXX-XXXX" aria-describedby="basic-addon2" pattern="CVE-\d{4}-\d{4,7}">
          <div class="input-group-append">
            <input type="submit" value="Save CVE" class="input-group-text btn-primary" id="basic-addon2"></input>
          </div>
        </div>
      </form>

      <button onclick="openCVEForm()" id="add-cve" class="btn btn-default" style="vertical-align: middle;background-color: #77b300;color: white;">
        <i class="fas fa-plus"></i>
      </button>
      <button onclick="deleteMode()" id="delete-mode" class="btn btn-default" style="vertical-align: middle;background-color: #e02342;color: white;">
        <i class="fas fa-trash-alt"></i>
      </button>
    </ul>

 
  </nav>
  <header id="cve-info" class="rounded border-tw"> 
    <h2>{{ cve }}</h2>
    <p>{{ description }}</p>

    <h5>Timeseries plot for this vulnerability</h5>

    <div class="container" id="CVETimeseriesDiv">
    <canvas id="line-chart" width="500" height="150"></canvas>
    </div>


    
    <p>Google Links:</p>
    <table class="table table-hover">
	{% for gL in googleLinks %}
        <tr class="table-info">   
          <td><a href="{{ gL }}">{{ gL }}</a></td>
	  <td>INFO/Posible Exploit</td>
	</tr>
        {% endfor %}
    </table>

    <div id="cve-table"> </div>
    <small>*Description ref: <a href="https://nvd.nist.gov/vuln/detail/{{ cve }}">https://nvd.nist.gov/vuln/detail/{{ cve }}</a></small>
  </header> 
  <section id="cve-renderLink" class="rounded border-tw">
    <h2>Streaming Data</h2>
  </section>
</main>

<script type="text/javascript">
    window.onload = function() {
      $('.dropdown-toggle').dropdown();
      $.getJSON("json/data.json", function(json) {
          loadData(json);
      });
    };
</script>  

<script>
function deleteMode() {
  var x = document.getElementById("delete-icon");
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
</script>

<script type="text/javascript">
var ctx = document.getElementById("line-chart"); ctx.style.backgroundColor = 'rgba(255,255,255,255)';

new Chart(document.getElementById("line-chart"), {
  type: 'line',
  data: {
    labels: ['2017-07-11', '2017-07-12', '2017-07-14', '2017-07-16', '2017-07-17', '2017-08-18', '2017-08-29', '2017-11-15', '2017-11-16', '2018-01-02', '2018-01-28', '2018-10-02', '2018-10-03', '2018-10-04', '2018-10-05', '2018-10-08', '2018-10-09', '2018-10-10', '2018-10-11', '2018-10-12', '2018-10-14', '2018-11-05', '2018-12-25', '2019-01-05', '2019-01-07', '2019-01-09', '2019-02-11', '2019-05-08', '2019-07-03', '2019-10-20', '2019-10-21', '2019-10-22', '2019-12-31', '2020-01-01', '2020-01-02', '2020-02-21', '2020-02-22', '2020-02-25', '2020-02-26', '2020-02-27', '2020-02-28', '2020-03-11', '2020-03-18', '2020-04-01', '2020-04-15', '2020-06-19', '2020-08-22', '2020-09-09'],
    datasets: [{ 
        data: [7, 2, 1, 2, 1, 8, 1, 1, 1, 1, 1, 29, 9, 2, 1, 18, 5, 1, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 6, 2, 2, 1, 1, 7, 2, 1, 4, 1, 1, 1, 1, 1, 1, 1],
        label: "Tweet Volume",
        borderColor: "#3e95cd",
        fill: false
      }, { 
        data: [1, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 733, 541, 2, 0, 10, 111, 0, 3, 3, 0, 4, 0, 41, 1, 0, 0, 0, 0, 0, 7, 0, 194, 0, 2, 0, 0, 200, 34, 7, 24, 0, 2, 0, 0, 0, 0, 0],
        label: "Likes Volume",
        borderColor: "#8e5ea2",
        fill: false
      }
    ]
  },
  options: {
    title: {
      display: true,
      text: 'Timeseries plot for {{ cve }}'
    },
    scales: {
      yAxes: [{
        scaleLabel: {
          display: true,
          labelString: 'NÂº Tweets'
        }
      }],
      xAxes: [{
        scaleLabel: {
          display: true,
          labelString: 'Date (%Y-%m-%d)'
        }
      }]


    }   
  }
});

</script>
{% endblock %} {% block footer %} {% endblock %}
