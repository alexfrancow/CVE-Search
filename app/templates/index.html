{% extends "layout.html" %}
{% block title %}CVE-Search{% endblock %}
{% block content %}

{% if new_cve %}
<div class="alert alert-dismissible alert-success">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  <strong>Well done!</strong> You successfully add {{ new_cve }}</a>.
</div>
{% endif %}

	<h1> CVE-Search</h1>

<main id="cve-main">
  <nav id="cve-nav">
    <div id="cve-options">
	<i class="fas fa-trash"></i>
    </div>

    <ul class="list-group">
    {% for row in rows %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="?cve={{ row[0]}}">{{ row[0]}}</a>
        <a href="/run?cve={{ row[0]}}" class="ml-auto pr-3"><i class="fas fa-play" aria-hidden="true"></i></a>
        <a href="#"><i class="fas fa-trash-alt" aria-hidden="true"></i></a>
      </li>
    {% endfor %}
      <form id="CVEForm" style="margin-top: 20px;display:none;" action="/createCVE" method="post">
        <div class="input-group mb-3">
          <input type="text" class="form-control" name="cve" placeholder="CVE-XXXX-XXXX" aria-label="CVE-XXXX-XXXX" aria-describedby="basic-addon2" pattern="CVE-\d{4}-\d{4,7}">
          <div class="input-group-append">
            <input type="submit" value="Save CVE" class="input-group-text" id="basic-addon2"></input>
          </div>
        </div>
      </form>

      <button onclick="openCVEForm()" id="add-cve" class="btn btn-default" style="vertical-align: middle;background-color: #77b300;color: white;">
        <i class="fas fa-plus"></i>
      </button>
    </ul>

 
  </nav>
  <header id="cve-info"> 
    <h1>{{ cve }}</h1>
    <p>{{ description }}</p>
    
    <p>Google Links:</p>
    <table class="table table-hover">
	{% for gL in googleLinks %}
        <tr class="table-info">   
          <td><a href="{{ gL }}">{{ gL }}</a></td>
	  <td>INFO/Posible Exploit</td>
	</tr>
        {% endfor %}
    </table>

    <div id="cve-table"> </div>
    <small>*Description ref: <a href="https://nvd.nist.gov/vuln/detail/{{ cve }}">https://nvd.nist.gov/vuln/detail/{{ cve }}</a></small>
  </header> 
  <section id="cve-renderLink">
    <h2>Render Page</h2>
  </section>
</main>  
{% endblock %} {% block footer %} {% endblock %}
