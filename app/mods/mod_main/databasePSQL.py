import psycopg2
import configparser

class PSQLDatabase():
    def __init__(self):
        config = configparser.ConfigParser()
        try:
            config.read('./config.ini')
        except FileExistsError as err:
            print('File exists error: {0}', err)
            sys.exit(1)

        dbname = config['PSQL']['dbname']
        user = config['PSQL']['user']
        password = config['PSQL']['pass']
        host = config['PSQL']['host']
        port = config['PSQL']['port']
        self.conn = psycopg2.connect(
                    dbname = dbname,
                    user = user,
                    host = host,
                    port = port,
                    password = password
        )
        self.cursor = self.conn.cursor()

    def query(self, query):
        self.cursor.execute(query)

    def close(self):
        self.cursor.close()
        self.conn.close()


