# CVE-Search

[![](https://img.shields.io/badge/twitter-@alexfrancow-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/alexfrancow) [![](https://img.shields.io/badge/linkedin-@alexfrancow-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/in/alexfrancow)

CVE-Search (name still in alpha), is a Machine Learning tool focused on the detection of exploits or proofs of concept in social networks such as Twitter, Github. It is also capable of doing related searches on Google, Yandex, DuckDuckGo on CVEs and detecting if the content may be a functional exploit, a proof of concept or simply information about the vulnerability.

<p align="center">
  <img src="https://github.com/alexfrancow/CVE-Search/blob/master/images/main.png"/>
</p>

## Getting started

```bash
$ git clone https://github.com/alexfrancow/CVE-Search && cd CVE-Search 
$ pip3 install -r requirements.txt
$ docker pull postgres
$ docker run --name some-postgres -e POSTGRES_PASSWORD=1234 -p 5432:5432 -e POSTGRES_DB=cve_search_db -e POSTGRES_USER=alexfranco postgres
$ nano config.ini # PSQL config
$ python3 run.py

# Manual PSQL interaction
$ apt install postgresql-client
$ psql -U alexfranco -h localhost -p 5432 cve_search_db

# Dataset download
$ pip3 install twint
$ pip3 install --user --upgrade git+https://github.com/twintproject/twint.git@origin/master#egg=twint
$ twint -s "cve-" --since 2019-01-01 -o cves-2019-2020.csv --csv --stats --filter-retweets
```

```python
# PSQL table creation
import psycopg2 
commands = ('''Create Table IF NOT EXISTS CVES(CVE_id TEXT PRIMARY KEY, Description TEXT, Publised_Date TEXT);''',
            '''Create Table IF NOT EXISTS TwitterTweets(Tweet_Id BIGINT PRIMARY KEY,
                                         CVE_id TEXT,
                                         Tweet TEXT,
                                         Datestamp TEXT,
                                         Retweet_Count INT,
                                         Replies_Count INT,
                                         Likes_Count INT,
                                         URLs TEXT,
                                         Username TEXT,
                                         CONSTRAINT fk_cves
                                             FOREIGN KEY(CVE_id)
                                                 REFERENCES CVES(CVE_id)
                                                 ON DELETE CASCADE);''')

conn = psycopg2.connect(
    dbname = "cve_search_db",
    user = "alexfranco",
    host = "192.168.1.63",
    port = 5432,
    password = "1234"
)
cursor = conn.cursor()
for command in commands:
    print(command)
    cursor.execute(command)
conn.commit()
cursor.close()
conn.close()
```
